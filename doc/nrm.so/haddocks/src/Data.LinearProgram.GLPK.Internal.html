<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-name-shadowing #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-type-defaults #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.LinearProgram.GLPK.Internal</span><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#writeProblem"><span class="hs-identifier hs-var">writeProblem</span></a><span class="hs-special">,</span><span>
</span><a name="line-9"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#solveSimplex"><span class="hs-identifier hs-var">solveSimplex</span></a><span class="hs-special">,</span><span>
</span><a name="line-10"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#mipSolve"><span class="hs-identifier hs-var">mipSolve</span></a><span class="hs-special">,</span><span>
</span><a name="line-11"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#getObjVal"><span class="hs-identifier hs-var">getObjVal</span></a><span class="hs-special">,</span><span>
</span><a name="line-12"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#getRowPrim"><span class="hs-identifier hs-var">getRowPrim</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#getColPrim"><span class="hs-identifier hs-var">getColPrim</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#mipObjVal"><span class="hs-identifier hs-var">mipObjVal</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#mipRowVal"><span class="hs-identifier hs-var">mipRowVal</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#mipColVal"><span class="hs-identifier hs-var">mipColVal</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#getBadRay"><span class="hs-identifier hs-var">getBadRay</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">where</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Data.LinearProgram.Common.html"><span class="hs-identifier">Data.LinearProgram.Common</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html"><span class="hs-identifier">Data.LinearProgram.GLPK.Types</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.C</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Marshal.Array</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Ptr</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_minimize&quot;</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-identifier">glpMinimize</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_maximize&quot;</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-identifier">glpMaximize</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_add_rows&quot;</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-identifier">glpAddRows</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_add_cols&quot;</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-identifier">glpAddCols</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_set_row_bnds&quot;</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-identifier">glpSetRowBnds</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_set_col_bnds&quot;</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-identifier">glpSetColBnds</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_set_obj_coef&quot;</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-identifier">glpSetObjCoef</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_set_mat_row&quot;</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-identifier">glpSetMatRow</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_solve_simplex&quot;</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-identifier">glpSolveSimplex</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_get_obj_val&quot;</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-identifier">glpGetObjVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_get_row_prim&quot;</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-identifier">glpGetRowPrim</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_get_col_prim&quot;</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-identifier">glpGetColPrim</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_set_col_kind&quot;</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-identifier">glpSetColKind</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_mip_solve&quot;</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-identifier">glpMipSolve</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_mip_obj_val&quot;</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-identifier">glpMIPObjVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_mip_row_val&quot;</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-identifier">glpMIPRowVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_mip_col_val&quot;</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-identifier">glpMIPColVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_set_row_name&quot;</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-identifier">glpSetRowName</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">ccall</span><span> </span><span class="hs-keyword">unsafe</span><span> </span><span class="hs-string">&quot;c_glp_get_bad_ray&quot;</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-identifier">glpGetBadRay</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GlpProb"><span class="hs-identifier hs-type">GlpProb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-identifier">setObjectiveDirection</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.LinearProgram.Types.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><a name="setObjectiveDirection"><a href="Data.LinearProgram.GLPK.Internal.html#setObjectiveDirection"><span class="hs-identifier">setObjectiveDirection</span></a></a><span> </span><a name="local-6989586621679220178"><a href="#local-6989586621679220178"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679220178"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-109"></a><span>  </span><a href="Data.LinearProgram.Types.html#Min"><span class="hs-identifier hs-var">Min</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpMinimize"><span class="hs-identifier hs-var">glpMinimize</span></a><span>
</span><a name="line-110"></a><span>  </span><a href="Data.LinearProgram.Types.html#Max"><span class="hs-identifier hs-var">Max</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpMaximize"><span class="hs-identifier hs-var">glpMaximize</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-identifier">getBadRay</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><a name="getBadRay"><a href="Data.LinearProgram.GLPK.Internal.html#getBadRay"><span class="hs-identifier">getBadRay</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679220179"><a href="#local-6989586621679220179"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220179"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220179"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpGetBadRay"><span class="hs-identifier hs-var">glpGetBadRay</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-identifier">addRows</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-116"></a><a name="addRows"><a href="Data.LinearProgram.GLPK.Internal.html#addRows"><span class="hs-identifier">addRows</span></a></a><span> </span><a name="local-6989586621679220180"><a href="#local-6989586621679220180"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpAddRows"><span class="hs-identifier hs-var">glpAddRows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220180"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-identifier">addCols</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-119"></a><a name="addCols"><a href="Data.LinearProgram.GLPK.Internal.html#addCols"><span class="hs-identifier">addCols</span></a></a><span> </span><a name="local-6989586621679220181"><a href="#local-6989586621679220181"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpAddCols"><span class="hs-identifier hs-var">glpAddCols</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220181"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-identifier">setRowBounds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679220177"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.Types.html#Bounds"><span class="hs-identifier hs-type">Bounds</span></a><span> </span><a href="#local-6989586621679220177"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><a name="setRowBounds"><a href="Data.LinearProgram.GLPK.Internal.html#setRowBounds"><span class="hs-identifier">setRowBounds</span></a></a><span> </span><a name="local-6989586621679220182"><a href="#local-6989586621679220182"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679220183"><a href="#local-6989586621679220183"><span class="hs-identifier">bds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220184"><a href="#local-6989586621679220184"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#onBounds"><span class="hs-identifier hs-var">onBounds</span></a><span> </span><span class="hs-special">(</span><a href="Data.LinearProgram.GLPK.Internal.html#glpSetRowBnds"><span class="hs-identifier hs-var">glpSetRowBnds</span></a><span> </span><a href="#local-6989586621679220184"><span class="hs-identifier hs-var">lp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220182"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220183"><span class="hs-identifier hs-var">bds</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-identifier">setColBounds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679220176"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.Types.html#Bounds"><span class="hs-identifier hs-type">Bounds</span></a><span> </span><a href="#local-6989586621679220176"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><a name="setColBounds"><a href="Data.LinearProgram.GLPK.Internal.html#setColBounds"><span class="hs-identifier">setColBounds</span></a></a><span> </span><a name="local-6989586621679220185"><a href="#local-6989586621679220185"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679220186"><a href="#local-6989586621679220186"><span class="hs-identifier">bds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220187"><a href="#local-6989586621679220187"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#onBounds"><span class="hs-identifier hs-var">onBounds</span></a><span> </span><span class="hs-special">(</span><a href="Data.LinearProgram.GLPK.Internal.html#glpSetColBnds"><span class="hs-identifier hs-var">glpSetColBnds</span></a><span> </span><a href="#local-6989586621679220187"><span class="hs-identifier hs-var">lp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220185"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220186"><span class="hs-identifier hs-var">bds</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-identifier">onBounds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679220174"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220175"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.Types.html#Bounds"><span class="hs-identifier hs-type">Bounds</span></a><span> </span><a href="#local-6989586621679220174"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220175"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-128"></a><a name="onBounds"><a href="Data.LinearProgram.GLPK.Internal.html#onBounds"><span class="hs-identifier">onBounds</span></a></a><span> </span><a name="local-6989586621679220188"><a href="#local-6989586621679220188"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679220189"><a href="#local-6989586621679220189"><span class="hs-identifier">bds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679220189"><span class="hs-identifier hs-var">bds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-129"></a><span>  </span><a href="Data.LinearProgram.Types.html#Free"><span class="hs-identifier hs-var">Free</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220188"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-130"></a><span>  </span><a href="Data.LinearProgram.Types.html#LBound"><span class="hs-identifier hs-var">LBound</span></a><span> </span><a name="local-6989586621679220190"><a href="#local-6989586621679220190"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220188"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220190"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-131"></a><span>  </span><a href="Data.LinearProgram.Types.html#UBound"><span class="hs-identifier hs-var">UBound</span></a><span> </span><a name="local-6989586621679220191"><a href="#local-6989586621679220191"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220188"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220191"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>  </span><a href="Data.LinearProgram.Types.html#Bound"><span class="hs-identifier hs-var">Bound</span></a><span> </span><a name="local-6989586621679220192"><a href="#local-6989586621679220192"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679220193"><a href="#local-6989586621679220193"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220188"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220192"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220193"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>  </span><a href="Data.LinearProgram.Types.html#Equ"><span class="hs-identifier hs-var">Equ</span></a><span> </span><a name="local-6989586621679220194"><a href="#local-6989586621679220194"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220188"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220194"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">setObjCoef</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Double</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">GLPK</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">GLPK</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-136"></a><span class="hs-identifier">setObjCoef</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679220173"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679220173"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><a name="setObjCoef"><a href="Data.LinearProgram.GLPK.Internal.html#setObjCoef"><span class="hs-identifier">setObjCoef</span></a></a><span> </span><a name="local-6989586621679220195"><a href="#local-6989586621679220195"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679220196"><a href="#local-6989586621679220196"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220197"><a href="#local-6989586621679220197"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpSetObjCoef"><span class="hs-identifier hs-var">glpSetObjCoef</span></a><span> </span><a href="#local-6989586621679220197"><span class="hs-identifier hs-var">lp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220195"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220196"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">setMatRow</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Double</span><span class="hs-pragma">)</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">GLPK</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Int</span><span class="hs-pragma">)</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">GLPK</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-140"></a><span class="hs-identifier">setMatRow</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679220172"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679220172"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><a name="setMatRow"><a href="Data.LinearProgram.GLPK.Internal.html#setMatRow"><span class="hs-identifier">setMatRow</span></a></a><span> </span><a name="local-6989586621679220198"><a href="#local-6989586621679220198"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679220199"><a href="#local-6989586621679220199"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220201"><a href="#local-6989586621679220201"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-identifier hs-var">allocaArray</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220200"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679220202"><a href="#local-6989586621679220202"><span class="hs-identifier">ixs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CInt</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">allocaArray</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220200"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679220203"><a href="#local-6989586621679220203"><span class="hs-identifier">coeffs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CDouble</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier hs-var">pokeArray</span><span> </span><a href="#local-6989586621679220202"><span class="hs-identifier hs-var">ixs</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220199"><span class="hs-identifier hs-var">row</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-identifier hs-var">pokeArray</span><span> </span><a href="#local-6989586621679220203"><span class="hs-identifier hs-var">coeffs</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220199"><span class="hs-identifier hs-var">row</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#glpSetMatRow"><span class="hs-identifier hs-var">glpSetMatRow</span></a><span> </span><a href="#local-6989586621679220201"><span class="hs-identifier hs-var">lp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220198"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220200"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220202"><span class="hs-identifier hs-var">ixs</span></a><span> </span><a href="#local-6989586621679220203"><span class="hs-identifier hs-var">coeffs</span></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-147"></a><span>    </span><a name="local-6989586621679220200"><a href="#local-6989586621679220200"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679220199"><span class="hs-identifier hs-var">row</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- createIndex :: GLPK ()</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- createIndex = GLP glpCreateIndex</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- findRow :: String -&gt; GLPK Int</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- findRow nam = GLP $ fmap fromIntegral . withCString nam . glpFindRow</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- findCol :: String -&gt; GLPK Int</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- findCol nam = GLP $ fmap fromIntegral . withCString nam . glpFindCol</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-identifier">solveSimplex</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#MsgLev"><span class="hs-identifier hs-type">MsgLev</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><a href="Data.LinearProgram.GLPK.Types.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a><span>
</span><a name="line-159"></a><a name="solveSimplex"><a href="Data.LinearProgram.GLPK.Internal.html#solveSimplex"><span class="hs-identifier">solveSimplex</span></a></a><span> </span><a name="local-6989586621679220204"><a href="#local-6989586621679220204"><span class="hs-identifier">msglev</span></a></a><span> </span><a name="local-6989586621679220205"><a href="#local-6989586621679220205"><span class="hs-identifier">tmLim</span></a></a><span> </span><a name="local-6989586621679220206"><a href="#local-6989586621679220206"><span class="hs-identifier">presolve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220208"><a href="#local-6989586621679220208"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpSolveSimplex"><span class="hs-identifier hs-var">glpSolveSimplex</span></a><span>
</span><a name="line-162"></a><span>      </span><a href="#local-6989586621679220208"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-163"></a><span>      </span><span class="hs-special">(</span><a href="Data.LinearProgram.GLPK.Internal.html#getMsgLev"><span class="hs-identifier hs-var">getMsgLev</span></a><span> </span><a href="#local-6989586621679220204"><span class="hs-identifier hs-var">msglev</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>      </span><a href="#local-6989586621679220207"><span class="hs-identifier hs-var">tmLim'</span></a><span>
</span><a name="line-165"></a><span>      </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679220206"><span class="hs-identifier hs-var">presolve</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>    </span><a name="local-6989586621679220207"><a href="#local-6989586621679220207"><span class="hs-identifier">tmLim'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220205"><span class="hs-identifier hs-var">tmLim</span></a><span> </span><a href="Algebra.Classes.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">1000</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-identifier">getMsgLev</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#MsgLev"><span class="hs-identifier hs-type">MsgLev</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-170"></a><a name="getMsgLev"><a href="Data.LinearProgram.GLPK.Internal.html#getMsgLev"><span class="hs-identifier">getMsgLev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-identifier">getObjVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-173"></a><a name="getObjVal"><a href="Data.LinearProgram.GLPK.Internal.html#getObjVal"><span class="hs-identifier">getObjVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpGetObjVal"><span class="hs-identifier hs-var">glpGetObjVal</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-identifier">getRowPrim</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-176"></a><a name="getRowPrim"><a href="Data.LinearProgram.GLPK.Internal.html#getRowPrim"><span class="hs-identifier">getRowPrim</span></a></a><span> </span><a name="local-6989586621679220209"><a href="#local-6989586621679220209"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.LinearProgram.GLPK.Internal.html#glpGetRowPrim"><span class="hs-identifier hs-var">glpGetRowPrim</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220209"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">getColPrim</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-179"></a><a name="getColPrim"><a href="Data.LinearProgram.GLPK.Internal.html#getColPrim"><span class="hs-identifier">getColPrim</span></a></a><span> </span><a name="local-6989586621679220210"><a href="#local-6989586621679220210"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.LinearProgram.GLPK.Internal.html#glpGetColPrim"><span class="hs-identifier hs-var">glpGetColPrim</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220210"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">setColKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.Types.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><a name="setColKind"><a href="Data.LinearProgram.GLPK.Internal.html#setColKind"><span class="hs-identifier">setColKind</span></a></a><span> </span><a name="local-6989586621679220211"><a href="#local-6989586621679220211"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679220212"><a href="#local-6989586621679220212"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220213"><a href="#local-6989586621679220213"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpSetColKind"><span class="hs-identifier hs-var">glpSetColKind</span></a><span> </span><a href="#local-6989586621679220213"><span class="hs-identifier hs-var">lp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220211"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">1</span><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679220212"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-identifier">mipSolve</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-185"></a><span>  </span><a href="Data.LinearProgram.GLPK.Types.html#MsgLev"><span class="hs-identifier hs-type">MsgLev</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-186"></a><span>  </span><a href="Data.LinearProgram.GLPK.Types.html#BranchingTechnique"><span class="hs-identifier hs-type">BranchingTechnique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-187"></a><span>  </span><a href="Data.LinearProgram.GLPK.Types.html#BacktrackTechnique"><span class="hs-identifier hs-type">BacktrackTechnique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-188"></a><span>  </span><a href="Data.LinearProgram.GLPK.Types.html#Preprocessing"><span class="hs-identifier hs-type">Preprocessing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-special">[</span><a href="Data.LinearProgram.GLPK.Types.html#Cuts"><span class="hs-identifier hs-type">Cuts</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-194"></a><span>  </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><a href="Data.LinearProgram.GLPK.Types.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a><span>
</span><a name="line-195"></a><a name="mipSolve"><a href="Data.LinearProgram.GLPK.Internal.html#mipSolve"><span class="hs-identifier">mipSolve</span></a></a><span> </span><a name="local-6989586621679220214"><a href="#local-6989586621679220214"><span class="hs-identifier">msglev</span></a></a><span> </span><a name="local-6989586621679220215"><a href="#local-6989586621679220215"><span class="hs-identifier">brt</span></a></a><span> </span><a name="local-6989586621679220216"><a href="#local-6989586621679220216"><span class="hs-identifier">btt</span></a></a><span> </span><a name="local-6989586621679220217"><a href="#local-6989586621679220217"><span class="hs-identifier">pp</span></a></a><span> </span><a name="local-6989586621679220218"><a href="#local-6989586621679220218"><span class="hs-identifier">fp</span></a></a><span> </span><a name="local-6989586621679220219"><a href="#local-6989586621679220219"><span class="hs-identifier">cuts</span></a></a><span> </span><a name="local-6989586621679220220"><a href="#local-6989586621679220220"><span class="hs-identifier">mipgap</span></a></a><span> </span><a name="local-6989586621679220221"><a href="#local-6989586621679220221"><span class="hs-identifier">tmlim</span></a></a><span> </span><a name="local-6989586621679220222"><a href="#local-6989586621679220222"><span class="hs-identifier">presol</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679220232"><a href="#local-6989586621679220232"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-197"></a><span>    </span><a href="Data.LinearProgram.GLPK.Internal.html#glpMipSolve"><span class="hs-identifier hs-var">glpMipSolve</span></a><span>
</span><a name="line-198"></a><span>      </span><a href="#local-6989586621679220232"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-199"></a><span>      </span><a href="#local-6989586621679220223"><span class="hs-identifier hs-var">msglev'</span></a><span>
</span><a name="line-200"></a><span>      </span><a href="#local-6989586621679220224"><span class="hs-identifier hs-var">brt'</span></a><span>
</span><a name="line-201"></a><span>      </span><a href="#local-6989586621679220225"><span class="hs-identifier hs-var">btt'</span></a><span>
</span><a name="line-202"></a><span>      </span><a href="#local-6989586621679220226"><span class="hs-identifier hs-var">pp'</span></a><span>
</span><a name="line-203"></a><span>      </span><a href="#local-6989586621679220227"><span class="hs-identifier hs-var">fp'</span></a><span>
</span><a name="line-204"></a><span>      </span><a href="#local-6989586621679220230"><span class="hs-identifier hs-var">tmlim'</span></a><span>
</span><a name="line-205"></a><span>      </span><a href="#local-6989586621679220228"><span class="hs-identifier hs-var">cuts'</span></a><span>
</span><a name="line-206"></a><span>      </span><a href="#local-6989586621679220229"><span class="hs-identifier hs-var">mipgap'</span></a><span>
</span><a name="line-207"></a><span>      </span><a href="#local-6989586621679220231"><span class="hs-identifier hs-var">presol'</span></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220223"><a href="#local-6989586621679220223"><span class="hs-identifier">msglev'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#getMsgLev"><span class="hs-identifier hs-var">getMsgLev</span></a><span> </span><a href="#local-6989586621679220214"><span class="hs-identifier hs-var">msglev</span></a><span>
</span><a name="line-210"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220224"><a href="#local-6989586621679220224"><span class="hs-identifier">brt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679220215"><span class="hs-identifier hs-var">brt</span></a><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220225"><a href="#local-6989586621679220225"><span class="hs-identifier">btt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679220216"><span class="hs-identifier hs-var">btt</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220226"><a href="#local-6989586621679220226"><span class="hs-identifier">pp'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679220217"><span class="hs-identifier hs-var">pp</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220227"><a href="#local-6989586621679220227"><span class="hs-identifier">fp'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679220218"><span class="hs-identifier hs-var">fp</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220228"><a href="#local-6989586621679220228"><span class="hs-identifier">cuts'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-215"></a><span>      </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GMI"><span class="hs-identifier hs-var">GMI</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679220219"><span class="hs-identifier hs-var">cuts</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>        </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#MIR"><span class="hs-identifier hs-var">MIR</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679220219"><span class="hs-identifier hs-var">cuts</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>        </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#Cov"><span class="hs-identifier hs-var">Cov</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679220219"><span class="hs-identifier hs-var">cuts</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>        </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#Clq"><span class="hs-identifier hs-var">Clq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679220219"><span class="hs-identifier hs-var">cuts</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220229"><a href="#local-6989586621679220229"><span class="hs-identifier">mipgap'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><a href="#local-6989586621679220220"><span class="hs-identifier hs-var">mipgap</span></a><span>
</span><a name="line-220"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220230"><a href="#local-6989586621679220230"><span class="hs-identifier">tmlim'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-number">1000</span><span> </span><a href="Algebra.Classes.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><a href="#local-6989586621679220221"><span class="hs-identifier hs-var">tmlim</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-glyph">!</span><a name="local-6989586621679220231"><a href="#local-6989586621679220231"><span class="hs-identifier">presol'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679220222"><span class="hs-identifier hs-var">presol</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">mipObjVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-224"></a><a name="mipObjVal"><a href="Data.LinearProgram.GLPK.Internal.html#mipObjVal"><span class="hs-identifier">mipObjVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpMIPObjVal"><span class="hs-identifier hs-var">glpMIPObjVal</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-identifier">mipRowVal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-227"></a><a name="mipRowVal"><a href="Data.LinearProgram.GLPK.Internal.html#mipRowVal"><span class="hs-identifier">mipRowVal</span></a></a><span> </span><a name="local-6989586621679220233"><a href="#local-6989586621679220233"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.LinearProgram.GLPK.Internal.html#glpMIPRowVal"><span class="hs-identifier hs-var">glpMIPRowVal</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220233"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-identifier">mipColVal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-230"></a><a name="mipColVal"><a href="Data.LinearProgram.GLPK.Internal.html#mipColVal"><span class="hs-identifier">mipColVal</span></a></a><span> </span><a name="local-6989586621679220234"><a href="#local-6989586621679220234"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.LinearProgram.GLPK.Internal.html#glpMIPColVal"><span class="hs-identifier hs-var">glpMIPColVal</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220234"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-identifier">setRowName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><a name="setRowName"><a href="Data.LinearProgram.GLPK.Internal.html#setRowName"><span class="hs-identifier">setRowName</span></a></a><span> </span><a name="local-6989586621679220235"><a href="#local-6989586621679220235"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679220236"><a href="#local-6989586621679220236"><span class="hs-identifier">nam</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLP"><span class="hs-identifier hs-var">GLP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">withCString</span><span> </span><a href="#local-6989586621679220236"><span class="hs-identifier hs-var">nam</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#glpSetRowName"><span class="hs-identifier hs-var">glpSetRowName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679220235"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">writeProblem</span><span> </span><span class="hs-pragma">::</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-pragma">Ord</span><span> </span><span class="hs-pragma">v</span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="hs-pragma">LP</span><span> </span><span class="hs-pragma">v</span><span> </span><span class="hs-pragma">Double</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">GLPK</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">v</span><span> </span><span class="hs-pragma">Int</span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-pragma">Ord</span><span> </span><span class="hs-pragma">v</span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="hs-pragma">LP</span><span> </span><span class="hs-pragma">v</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">GLPK</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Map</span><span> </span><span class="hs-pragma">v</span><span> </span><span class="hs-pragma">Int</span><span class="hs-pragma">)</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-239"></a><span class="hs-identifier">writeProblem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679220168"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679220169"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.LinearProgram.Spec.html#LP"><span class="hs-identifier hs-type">LP</span></a><span> </span><a href="#local-6989586621679220168"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679220169"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.LinearProgram.GLPK.Types.html#GLPK"><span class="hs-identifier hs-type">GLPK</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679220168"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><a name="writeProblem"><a href="Data.LinearProgram.GLPK.Internal.html#writeProblem"><span class="hs-identifier">writeProblem</span></a></a><span> </span><a href="Data.LinearProgram.Spec.html#LP"><span class="hs-identifier hs-var">LP</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-241"></a><span>  </span><a href="Data.LinearProgram.GLPK.Internal.html#setObjectiveDirection"><span class="hs-identifier hs-var">setObjectiveDirection</span></a><span> </span><a href="#local-6989586621679220337"><span class="hs-identifier hs-var">direction</span></a><span>
</span><a name="line-242"></a><span>  </span><a name="local-6989586621679220347"><a href="#local-6989586621679220347"><span class="hs-identifier">i0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#addCols"><span class="hs-identifier hs-var">addCols</span></a><span> </span><a href="#local-6989586621679220343"><span class="hs-identifier hs-var">nVars</span></a><span>
</span><a name="line-243"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220348"><a href="#local-6989586621679220348"><span class="hs-identifier">allVars'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220347"><span class="hs-identifier hs-var">i0</span></a><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220344"><span class="hs-identifier hs-var">allVars</span></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span> </span><span class="hs-special">[</span><a href="Data.LinearProgram.GLPK.Internal.html#setObjCoef"><span class="hs-identifier hs-var">setObjCoef</span></a><span> </span><a href="#local-6989586621679220349"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679220350"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679220349"><a href="#local-6989586621679220349"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679220350"><a href="#local-6989586621679220350"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">intersectionWith</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220348"><span class="hs-identifier hs-var">allVars'</span></a><span> </span><a href="#local-6989586621679220338"><span class="hs-identifier hs-var">objective</span></a><span class="hs-special">]</span><span>
</span><a name="line-245"></a><span>  </span><a name="local-6989586621679220351"><a href="#local-6989586621679220351"><span class="hs-identifier">j0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#addRows"><span class="hs-identifier hs-var">addRows</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679220339"><span class="hs-identifier hs-var">constraints</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-248"></a><span>        </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.LinearProgram.GLPK.Internal.html#setRowName"><span class="hs-identifier hs-var">setRowName</span></a><span> </span><a href="#local-6989586621679220352"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220353"><span class="hs-identifier hs-var">lab</span></a><span>
</span><a name="line-249"></a><span>        </span><a href="Data.LinearProgram.GLPK.Internal.html#setMatRow"><span class="hs-identifier hs-var">setMatRow</span></a><span>
</span><a name="line-250"></a><span>          </span><a href="#local-6989586621679220352"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-251"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679220356"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679220357"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679220356"><a href="#local-6989586621679220356"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679220357"><a href="#local-6989586621679220357"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intersectionWith</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220348"><span class="hs-identifier hs-var">allVars'</span></a><span> </span><a href="#local-6989586621679220354"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-252"></a><span>        </span><a href="Data.LinearProgram.GLPK.Internal.html#setRowBounds"><span class="hs-identifier hs-var">setRowBounds</span></a><span> </span><a href="#local-6989586621679220352"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679220355"><span class="hs-identifier hs-var">bnds</span></a><span>
</span><a name="line-253"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679220352"><a href="#local-6989586621679220352"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span> </span><a href="Data.LinearProgram.Spec.html#Constr"><span class="hs-identifier hs-var">Constr</span></a><span> </span><a name="local-6989586621679220353"><a href="#local-6989586621679220353"><span class="hs-identifier">lab</span></a></a><span> </span><a name="local-6989586621679220354"><a href="#local-6989586621679220354"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679220355"><a href="#local-6989586621679220355"><span class="hs-identifier">bnds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679220351"><span class="hs-identifier hs-var">j0</span></a><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679220339"><span class="hs-identifier hs-var">constraints</span></a><span>
</span><a name="line-254"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#setColBounds"><span class="hs-identifier hs-var">setColBounds</span></a><span> </span><a href="#local-6989586621679220358"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679220359"><span class="hs-identifier hs-var">bnds</span></a><span>
</span><a name="line-257"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679220358"><a href="#local-6989586621679220358"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679220359"><a href="#local-6989586621679220359"><span class="hs-identifier">bnds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">intersectionWith</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220348"><span class="hs-identifier hs-var">allVars'</span></a><span> </span><a href="#local-6989586621679220340"><span class="hs-identifier hs-var">varBounds</span></a><span>
</span><a name="line-258"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-259"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span>
</span><a name="line-260"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#setColBounds"><span class="hs-identifier hs-var">setColBounds</span></a><span> </span><a href="#local-6989586621679220360"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="Data.LinearProgram.Types.html#Free"><span class="hs-identifier hs-var">Free</span></a><span>
</span><a name="line-261"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679220360"><a href="#local-6989586621679220360"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">difference</span><span> </span><a href="#local-6989586621679220348"><span class="hs-identifier hs-var">allVars'</span></a><span> </span><a href="#local-6989586621679220340"><span class="hs-identifier hs-var">varBounds</span></a><span>
</span><a name="line-262"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span>
</span><a name="line-264"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Data.LinearProgram.GLPK.Internal.html#setColKind"><span class="hs-identifier hs-var">setColKind</span></a><span> </span><a href="#local-6989586621679220361"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679220362"><span class="hs-identifier hs-var">knd</span></a><span>
</span><a name="line-265"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679220361"><a href="#local-6989586621679220361"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679220362"><a href="#local-6989586621679220362"><span class="hs-identifier">knd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">elems</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">intersectionWith</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220348"><span class="hs-identifier hs-var">allVars'</span></a><span> </span><a href="#local-6989586621679220341"><span class="hs-identifier hs-var">varTypes</span></a><span>
</span><a name="line-266"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679220348"><span class="hs-identifier hs-var">allVars'</span></a><span>
</span><a name="line-268"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-269"></a><span>    </span><a name="local-6989586621679220342"><a href="#local-6989586621679220342"><span class="hs-identifier">allVars0</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-270"></a><span>      </span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679220338"><span class="hs-identifier hs-var">objective</span></a><span>
</span><a name="line-271"></a><span>        </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">unions</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679220345"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.LinearProgram.Spec.html#Constr"><span class="hs-identifier hs-var">Constr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679220345"><a href="#local-6989586621679220345"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220339"><span class="hs-identifier hs-var">constraints</span></a><span class="hs-special">]</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679220340"><span class="hs-identifier hs-var">varBounds</span></a><span>
</span><a name="line-273"></a><span>        </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679220341"><span class="hs-identifier hs-var">varTypes</span></a><span>
</span><a name="line-274"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679220343"><a href="#local-6989586621679220343"><span class="hs-identifier">nVars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679220344"><a href="#local-6989586621679220344"><span class="hs-identifier">allVars</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapAccum</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679220346"><a href="#local-6989586621679220346"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220346"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Algebra.Classes.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679220346"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220342"><span class="hs-identifier hs-var">allVars0</span></a><span>
</span><a name="line-275"></a></pre></body></html>